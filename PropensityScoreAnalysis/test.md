Propensity Score Analysis
================

We usually estimate treatment effect through randomized experiment where
there is a control group and a experimental group. However it is often
the case that treatments were not randomly assigned to
subjects.

## Data Exploring

``` r
data <- read.csv("http://web.hku.hk/~bcowling/data/propensity.csv", header=TRUE)
data$death = as.factor(data$death)
data$trt = as.factor(data$trt)
data
```

<div data-pagedtable="false">

<script data-pagedtable-source type="application/json">
{"columns":[{"label":["age"],"name":[1],"type":["int"],"align":["right"]},{"label":["male"],"name":[2],"type":["int"],"align":["right"]},{"label":["risk"],"name":[3],"type":["int"],"align":["right"]},{"label":["severity"],"name":[4],"type":["int"],"align":["right"]},{"label":["trt"],"name":[5],"type":["fctr"],"align":["left"]},{"label":["death"],"name":[6],"type":["fctr"],"align":["left"]}],"data":[{"1":"48","2":"1","3":"3","4":"8","5":"0","6":"0"},{"1":"59","2":"1","3":"4","4":"6","5":"1","6":"0"},{"1":"67","2":"1","3":"3","4":"6","5":"0","6":"1"},{"1":"51","2":"1","3":"0","4":"6","5":"0","6":"0"},{"1":"56","2":"1","3":"1","4":"6","5":"1","6":"0"},{"1":"60","2":"1","3":"1","4":"6","5":"0","6":"0"},{"1":"53","2":"1","3":"0","4":"3","5":"1","6":"0"},{"1":"54","2":"1","3":"1","4":"2","5":"0","6":"0"},{"1":"54","2":"1","3":"2","4":"7","5":"0","6":"0"},{"1":"62","2":"1","3":"0","4":"4","5":"0","6":"0"},{"1":"64","2":"1","3":"2","4":"6","5":"1","6":"1"},{"1":"70","2":"1","3":"3","4":"8","5":"1","6":"0"},{"1":"51","2":"1","3":"1","4":"5","5":"1","6":"0"},{"1":"59","2":"1","3":"0","4":"3","5":"1","6":"0"},{"1":"63","2":"1","3":"2","4":"4","5":"0","6":"0"},{"1":"46","2":"1","3":"0","4":"5","5":"0","6":"0"},{"1":"67","2":"1","3":"0","4":"6","5":"0","6":"0"},{"1":"69","2":"1","3":"3","4":"3","5":"1","6":"0"},{"1":"57","2":"1","3":"1","4":"5","5":"1","6":"0"},{"1":"58","2":"1","3":"3","4":"6","5":"0","6":"0"},{"1":"61","2":"1","3":"2","4":"9","5":"1","6":"0"},{"1":"50","2":"1","3":"0","4":"2","5":"1","6":"0"},{"1":"55","2":"1","3":"4","4":"4","5":"0","6":"1"},{"1":"54","2":"1","3":"3","4":"2","5":"0","6":"0"},{"1":"44","2":"1","3":"1","4":"4","5":"1","6":"0"},{"1":"53","2":"1","3":"0","4":"2","5":"0","6":"0"},{"1":"43","2":"1","3":"0","4":"1","5":"1","6":"0"},{"1":"68","2":"1","3":"3","4":"4","5":"0","6":"0"},{"1":"67","2":"1","3":"4","4":"7","5":"1","6":"0"},{"1":"41","2":"1","3":"0","4":"8","5":"0","6":"1"},{"1":"42","2":"1","3":"0","4":"2","5":"0","6":"0"},{"1":"67","2":"1","3":"2","4":"7","5":"1","6":"0"},{"1":"70","2":"1","3":"1","4":"4","5":"0","6":"1"},{"1":"59","2":"1","3":"3","4":"5","5":"1","6":"0"},{"1":"48","2":"1","3":"1","4":"1","5":"0","6":"0"},{"1":"68","2":"1","3":"4","4":"3","5":"1","6":"0"},{"1":"47","2":"1","3":"1","4":"5","5":"1","6":"0"},{"1":"62","2":"1","3":"3","4":"5","5":"1","6":"0"},{"1":"47","2":"1","3":"0","4":"3","5":"1","6":"0"},{"1":"61","2":"1","3":"1","4":"5","5":"1","6":"0"},{"1":"48","2":"1","3":"0","4":"10","5":"0","6":"0"},{"1":"60","2":"1","3":"1","4":"7","5":"1","6":"0"},{"1":"64","2":"1","3":"3","4":"10","5":"1","6":"0"},{"1":"55","2":"1","3":"5","4":"8","5":"0","6":"0"},{"1":"45","2":"1","3":"0","4":"3","5":"0","6":"0"},{"1":"65","2":"1","3":"1","4":"1","5":"0","6":"0"},{"1":"57","2":"1","3":"0","4":"4","5":"1","6":"0"},{"1":"58","2":"1","3":"0","4":"10","5":"1","6":"0"},{"1":"56","2":"1","3":"4","4":"5","5":"1","6":"0"},{"1":"70","2":"1","3":"1","4":"3","5":"0","6":"0"},{"1":"46","2":"1","3":"1","4":"5","5":"0","6":"0"},{"1":"46","2":"1","3":"0","4":"1","5":"0","6":"0"},{"1":"61","2":"1","3":"4","4":"8","5":"1","6":"0"},{"1":"64","2":"1","3":"4","4":"6","5":"0","6":"0"},{"1":"48","2":"1","3":"0","4":"2","5":"1","6":"0"},{"1":"60","2":"1","3":"4","4":"8","5":"1","6":"0"},{"1":"42","2":"1","3":"0","4":"5","5":"0","6":"0"},{"1":"53","2":"1","3":"0","4":"4","5":"0","6":"0"},{"1":"68","2":"1","3":"2","4":"4","5":"1","6":"0"},{"1":"49","2":"1","3":"1","4":"2","5":"0","6":"0"},{"1":"59","2":"1","3":"0","4":"5","5":"0","6":"0"},{"1":"69","2":"1","3":"5","4":"7","5":"1","6":"0"},{"1":"61","2":"1","3":"3","4":"4","5":"1","6":"0"},{"1":"40","2":"1","3":"0","4":"4","5":"0","6":"0"},{"1":"62","2":"1","3":"0","4":"5","5":"0","6":"0"},{"1":"65","2":"1","3":"4","4":"6","5":"1","6":"0"},{"1":"42","2":"1","3":"1","4":"5","5":"1","6":"0"},{"1":"59","2":"1","3":"1","4":"2","5":"0","6":"0"},{"1":"69","2":"1","3":"5","4":"9","5":"1","6":"0"},{"1":"59","2":"1","3":"0","4":"2","5":"0","6":"0"},{"1":"44","2":"1","3":"0","4":"5","5":"0","6":"0"},{"1":"50","2":"1","3":"0","4":"6","5":"0","6":"0"},{"1":"58","2":"1","3":"2","4":"4","5":"0","6":"0"},{"1":"60","2":"1","3":"3","4":"4","5":"0","6":"1"},{"1":"41","2":"1","3":"0","4":"5","5":"1","6":"0"},{"1":"47","2":"1","3":"0","4":"2","5":"1","6":"0"},{"1":"66","2":"1","3":"2","4":"5","5":"1","6":"0"},{"1":"49","2":"1","3":"2","4":"4","5":"1","6":"0"},{"1":"40","2":"1","3":"0","4":"4","5":"0","6":"0"},{"1":"62","2":"1","3":"2","4":"4","5":"1","6":"0"},{"1":"49","2":"1","3":"0","4":"1","5":"0","6":"0"},{"1":"59","2":"1","3":"1","4":"7","5":"1","6":"0"},{"1":"43","2":"1","3":"0","4":"5","5":"1","6":"1"},{"1":"61","2":"1","3":"2","4":"5","5":"1","6":"0"},{"1":"70","2":"1","3":"1","4":"6","5":"1","6":"1"},{"1":"62","2":"1","3":"2","4":"5","5":"1","6":"0"},{"1":"57","2":"1","3":"2","4":"6","5":"1","6":"0"},{"1":"47","2":"1","3":"1","4":"4","5":"0","6":"1"},{"1":"55","2":"1","3":"0","4":"4","5":"1","6":"0"},{"1":"57","2":"1","3":"2","4":"3","5":"1","6":"0"},{"1":"70","2":"1","3":"4","4":"4","5":"1","6":"0"},{"1":"50","2":"1","3":"2","4":"7","5":"1","6":"0"},{"1":"59","2":"1","3":"3","4":"3","5":"0","6":"0"},{"1":"53","2":"1","3":"2","4":"4","5":"1","6":"1"},{"1":"63","2":"1","3":"3","4":"7","5":"0","6":"1"},{"1":"61","2":"1","3":"1","4":"5","5":"1","6":"0"},{"1":"58","2":"1","3":"2","4":"2","5":"0","6":"1"},{"1":"59","2":"1","3":"2","4":"4","5":"1","6":"0"},{"1":"53","2":"1","3":"2","4":"4","5":"0","6":"0"},{"1":"41","2":"1","3":"0","4":"5","5":"0","6":"0"},{"1":"64","2":"1","3":"2","4":"6","5":"0","6":"0"},{"1":"52","2":"1","3":"2","4":"10","5":"0","6":"0"},{"1":"61","2":"1","3":"2","4":"2","5":"1","6":"0"},{"1":"64","2":"1","3":"2","4":"8","5":"1","6":"0"},{"1":"54","2":"1","3":"0","4":"8","5":"0","6":"0"},{"1":"61","2":"1","3":"0","4":"5","5":"0","6":"0"},{"1":"67","2":"1","3":"3","4":"5","5":"1","6":"0"},{"1":"62","2":"1","3":"5","4":"9","5":"1","6":"0"},{"1":"61","2":"1","3":"1","4":"3","5":"1","6":"1"},{"1":"65","2":"1","3":"2","4":"5","5":"0","6":"0"},{"1":"49","2":"1","3":"0","4":"3","5":"1","6":"0"},{"1":"46","2":"1","3":"0","4":"2","5":"0","6":"0"},{"1":"51","2":"1","3":"1","4":"3","5":"0","6":"0"},{"1":"63","2":"1","3":"1","4":"2","5":"1","6":"1"},{"1":"48","2":"1","3":"0","4":"3","5":"0","6":"1"},{"1":"66","2":"1","3":"0","4":"3","5":"0","6":"1"},{"1":"67","2":"1","3":"2","4":"4","5":"0","6":"1"},{"1":"59","2":"1","3":"1","4":"4","5":"1","6":"0"},{"1":"63","2":"1","3":"0","4":"2","5":"1","6":"0"},{"1":"62","2":"1","3":"2","4":"4","5":"1","6":"0"},{"1":"54","2":"1","3":"0","4":"4","5":"1","6":"0"},{"1":"60","2":"1","3":"3","4":"6","5":"1","6":"0"},{"1":"70","2":"1","3":"3","4":"3","5":"0","6":"0"},{"1":"68","2":"1","3":"3","4":"8","5":"1","6":"1"},{"1":"53","2":"1","3":"1","4":"5","5":"0","6":"0"},{"1":"52","2":"1","3":"2","4":"4","5":"0","6":"0"},{"1":"42","2":"1","3":"0","4":"3","5":"0","6":"1"},{"1":"60","2":"1","3":"3","4":"6","5":"0","6":"1"},{"1":"63","2":"1","3":"1","4":"1","5":"1","6":"0"},{"1":"67","2":"1","3":"4","4":"5","5":"0","6":"0"},{"1":"61","2":"1","3":"4","4":"3","5":"1","6":"0"},{"1":"41","2":"1","3":"0","4":"3","5":"0","6":"0"},{"1":"67","2":"1","3":"1","4":"6","5":"1","6":"1"},{"1":"44","2":"1","3":"0","4":"2","5":"0","6":"0"},{"1":"45","2":"1","3":"0","4":"4","5":"1","6":"0"},{"1":"55","2":"1","3":"0","4":"5","5":"1","6":"0"},{"1":"56","2":"1","3":"2","4":"2","5":"0","6":"0"},{"1":"44","2":"1","3":"1","4":"3","5":"1","6":"0"},{"1":"44","2":"1","3":"1","4":"4","5":"0","6":"0"},{"1":"63","2":"1","3":"4","4":"6","5":"1","6":"1"},{"1":"67","2":"1","3":"2","4":"9","5":"1","6":"0"},{"1":"68","2":"1","3":"2","4":"4","5":"0","6":"0"},{"1":"52","2":"1","3":"1","4":"4","5":"0","6":"1"},{"1":"55","2":"1","3":"2","4":"6","5":"0","6":"0"},{"1":"61","2":"1","3":"2","4":"5","5":"0","6":"0"},{"1":"53","2":"1","3":"0","4":"5","5":"1","6":"0"},{"1":"64","2":"1","3":"2","4":"5","5":"1","6":"0"},{"1":"66","2":"1","3":"5","4":"5","5":"1","6":"0"},{"1":"59","2":"1","3":"4","4":"5","5":"1","6":"0"},{"1":"57","2":"1","3":"1","4":"1","5":"1","6":"0"},{"1":"50","2":"1","3":"1","4":"9","5":"1","6":"1"},{"1":"54","2":"1","3":"1","4":"6","5":"1","6":"1"},{"1":"65","2":"1","3":"2","4":"3","5":"1","6":"0"},{"1":"55","2":"1","3":"3","4":"9","5":"0","6":"0"},{"1":"70","2":"1","3":"5","4":"6","5":"1","6":"1"},{"1":"40","2":"1","3":"0","4":"3","5":"0","6":"0"},{"1":"64","2":"1","3":"4","4":"8","5":"1","6":"1"},{"1":"54","2":"1","3":"0","4":"4","5":"0","6":"0"},{"1":"68","2":"1","3":"2","4":"7","5":"1","6":"0"},{"1":"61","2":"1","3":"3","4":"4","5":"1","6":"0"},{"1":"55","2":"1","3":"3","4":"5","5":"0","6":"0"},{"1":"55","2":"1","3":"4","4":"4","5":"0","6":"0"},{"1":"63","2":"1","3":"4","4":"7","5":"1","6":"0"},{"1":"50","2":"1","3":"1","4":"5","5":"0","6":"0"},{"1":"57","2":"1","3":"2","4":"5","5":"1","6":"0"},{"1":"56","2":"1","3":"2","4":"7","5":"0","6":"0"},{"1":"62","2":"1","3":"3","4":"6","5":"1","6":"0"},{"1":"62","2":"1","3":"4","4":"5","5":"1","6":"0"},{"1":"58","2":"1","3":"2","4":"3","5":"0","6":"0"},{"1":"63","2":"1","3":"3","4":"3","5":"0","6":"1"},{"1":"44","2":"1","3":"1","4":"2","5":"0","6":"0"},{"1":"64","2":"1","3":"4","4":"7","5":"0","6":"0"},{"1":"44","2":"1","3":"0","4":"3","5":"0","6":"0"},{"1":"62","2":"1","3":"1","4":"4","5":"0","6":"1"},{"1":"52","2":"1","3":"1","4":"4","5":"0","6":"0"},{"1":"60","2":"1","3":"2","4":"4","5":"0","6":"1"},{"1":"55","2":"1","3":"1","4":"4","5":"0","6":"1"},{"1":"70","2":"1","3":"3","4":"6","5":"1","6":"0"},{"1":"48","2":"1","3":"4","4":"7","5":"1","6":"0"},{"1":"58","2":"1","3":"0","4":"3","5":"0","6":"0"},{"1":"55","2":"1","3":"1","4":"6","5":"0","6":"0"},{"1":"67","2":"1","3":"3","4":"3","5":"1","6":"0"},{"1":"58","2":"1","3":"3","4":"7","5":"0","6":"0"},{"1":"43","2":"1","3":"1","4":"3","5":"1","6":"0"},{"1":"50","2":"1","3":"2","4":"8","5":"1","6":"0"},{"1":"51","2":"1","3":"1","4":"7","5":"1","6":"0"},{"1":"44","2":"1","3":"0","4":"4","5":"0","6":"0"},{"1":"64","2":"1","3":"3","4":"10","5":"1","6":"0"},{"1":"68","2":"1","3":"3","4":"2","5":"0","6":"0"},{"1":"61","2":"1","3":"3","4":"5","5":"0","6":"0"},{"1":"43","2":"1","3":"2","4":"4","5":"1","6":"0"},{"1":"41","2":"1","3":"0","4":"6","5":"0","6":"0"},{"1":"53","2":"1","3":"2","4":"4","5":"0","6":"0"},{"1":"63","2":"1","3":"3","4":"5","5":"0","6":"0"},{"1":"70","2":"1","3":"5","4":"7","5":"1","6":"0"},{"1":"64","2":"1","3":"0","4":"7","5":"1","6":"0"},{"1":"58","2":"1","3":"2","4":"5","5":"1","6":"0"},{"1":"52","2":"1","3":"1","4":"6","5":"1","6":"1"},{"1":"67","2":"1","3":"3","4":"8","5":"1","6":"0"},{"1":"56","2":"1","3":"1","4":"6","5":"1","6":"0"},{"1":"41","2":"1","3":"0","4":"7","5":"0","6":"0"},{"1":"61","2":"1","3":"1","4":"6","5":"0","6":"0"},{"1":"69","2":"1","3":"0","4":"7","5":"1","6":"0"},{"1":"62","2":"1","3":"0","4":"8","5":"0","6":"1"},{"1":"55","2":"1","3":"1","4":"2","5":"0","6":"1"},{"1":"57","2":"1","3":"1","4":"3","5":"0","6":"0"},{"1":"51","2":"1","3":"2","4":"4","5":"0","6":"0"},{"1":"59","2":"1","3":"1","4":"3","5":"0","6":"1"},{"1":"66","2":"1","3":"5","4":"4","5":"1","6":"1"},{"1":"67","2":"1","3":"3","4":"7","5":"1","6":"0"},{"1":"49","2":"1","3":"1","4":"4","5":"0","6":"0"},{"1":"52","2":"1","3":"2","4":"5","5":"0","6":"0"},{"1":"58","2":"1","3":"3","4":"8","5":"0","6":"0"},{"1":"44","2":"1","3":"0","4":"2","5":"1","6":"0"},{"1":"66","2":"1","3":"5","4":"8","5":"1","6":"0"},{"1":"59","2":"1","3":"1","4":"9","5":"0","6":"0"},{"1":"56","2":"1","3":"0","4":"0","5":"1","6":"0"},{"1":"58","2":"1","3":"1","4":"3","5":"1","6":"0"},{"1":"52","2":"1","3":"0","4":"6","5":"1","6":"0"},{"1":"53","2":"1","3":"3","4":"2","5":"1","6":"1"},{"1":"61","2":"1","3":"1","4":"7","5":"1","6":"0"},{"1":"70","2":"1","3":"4","4":"2","5":"0","6":"1"},{"1":"49","2":"1","3":"1","4":"2","5":"0","6":"0"},{"1":"53","2":"1","3":"2","4":"6","5":"0","6":"0"},{"1":"66","2":"1","3":"1","4":"5","5":"0","6":"0"},{"1":"57","2":"1","3":"3","4":"9","5":"1","6":"0"},{"1":"52","2":"1","3":"0","4":"4","5":"0","6":"0"},{"1":"59","2":"1","3":"1","4":"4","5":"0","6":"0"},{"1":"54","2":"1","3":"0","4":"4","5":"0","6":"0"},{"1":"65","2":"1","3":"1","4":"5","5":"1","6":"1"},{"1":"60","2":"1","3":"1","4":"7","5":"0","6":"0"},{"1":"40","2":"1","3":"0","4":"3","5":"0","6":"0"},{"1":"52","2":"1","3":"2","4":"3","5":"0","6":"0"},{"1":"69","2":"1","3":"2","4":"4","5":"1","6":"0"},{"1":"62","2":"1","3":"0","4":"4","5":"0","6":"0"},{"1":"62","2":"1","3":"1","4":"3","5":"1","6":"0"},{"1":"59","2":"1","3":"2","4":"3","5":"1","6":"0"},{"1":"68","2":"1","3":"2","4":"5","5":"0","6":"0"},{"1":"70","2":"1","3":"2","4":"9","5":"1","6":"1"},{"1":"45","2":"1","3":"0","4":"0","5":"0","6":"1"},{"1":"69","2":"1","3":"3","4":"8","5":"0","6":"1"},{"1":"66","2":"1","3":"2","4":"2","5":"1","6":"0"},{"1":"47","2":"1","3":"0","4":"4","5":"0","6":"0"},{"1":"61","2":"1","3":"3","4":"6","5":"1","6":"0"},{"1":"66","2":"1","3":"3","4":"7","5":"0","6":"0"},{"1":"63","2":"1","3":"1","4":"6","5":"0","6":"0"},{"1":"44","2":"1","3":"0","4":"5","5":"0","6":"0"},{"1":"51","2":"1","3":"1","4":"1","5":"0","6":"0"},{"1":"57","2":"1","3":"4","4":"3","5":"0","6":"0"},{"1":"53","2":"1","3":"0","4":"1","5":"0","6":"0"},{"1":"65","2":"1","3":"4","4":"7","5":"1","6":"0"},{"1":"53","2":"1","3":"1","4":"5","5":"0","6":"0"},{"1":"62","2":"1","3":"2","4":"6","5":"1","6":"0"},{"1":"42","2":"1","3":"0","4":"4","5":"0","6":"0"},{"1":"70","2":"1","3":"4","4":"7","5":"0","6":"1"},{"1":"58","2":"1","3":"4","4":"8","5":"1","6":"1"},{"1":"47","2":"1","3":"0","4":"5","5":"1","6":"0"},{"1":"62","2":"1","3":"3","4":"3","5":"0","6":"0"},{"1":"45","2":"1","3":"1","4":"5","5":"0","6":"0"},{"1":"64","2":"1","3":"0","4":"3","5":"0","6":"0"},{"1":"48","2":"1","3":"0","4":"6","5":"0","6":"0"},{"1":"61","2":"1","3":"3","4":"5","5":"1","6":"0"},{"1":"59","2":"1","3":"1","4":"1","5":"0","6":"1"},{"1":"66","2":"1","3":"2","4":"6","5":"1","6":"0"},{"1":"46","2":"1","3":"0","4":"2","5":"0","6":"0"},{"1":"51","2":"1","3":"1","4":"0","5":"0","6":"1"},{"1":"45","2":"1","3":"0","4":"3","5":"1","6":"0"},{"1":"65","2":"1","3":"3","4":"2","5":"0","6":"0"},{"1":"66","2":"1","3":"4","4":"5","5":"1","6":"0"},{"1":"46","2":"1","3":"1","4":"2","5":"0","6":"0"},{"1":"62","2":"1","3":"1","4":"4","5":"0","6":"0"},{"1":"52","2":"1","3":"0","4":"4","5":"1","6":"0"},{"1":"54","2":"1","3":"1","4":"7","5":"0","6":"0"},{"1":"55","2":"1","3":"0","4":"2","5":"0","6":"0"},{"1":"57","2":"1","3":"1","4":"5","5":"0","6":"0"},{"1":"57","2":"1","3":"3","4":"4","5":"0","6":"0"},{"1":"63","2":"1","3":"3","4":"4","5":"0","6":"0"},{"1":"60","2":"1","3":"2","4":"4","5":"1","6":"1"},{"1":"55","2":"1","3":"4","4":"6","5":"1","6":"0"},{"1":"45","2":"1","3":"0","4":"6","5":"0","6":"0"},{"1":"58","2":"1","3":"1","4":"7","5":"1","6":"0"},{"1":"52","2":"1","3":"2","4":"6","5":"1","6":"0"},{"1":"70","2":"1","3":"2","4":"5","5":"1","6":"0"},{"1":"45","2":"1","3":"1","4":"3","5":"0","6":"0"},{"1":"43","2":"1","3":"0","4":"2","5":"1","6":"0"},{"1":"69","2":"1","3":"3","4":"4","5":"0","6":"0"},{"1":"60","2":"1","3":"0","4":"8","5":"0","6":"1"},{"1":"70","2":"1","3":"5","4":"6","5":"1","6":"0"},{"1":"54","2":"1","3":"1","4":"9","5":"0","6":"0"},{"1":"69","2":"1","3":"5","4":"5","5":"1","6":"0"},{"1":"63","2":"1","3":"1","4":"6","5":"1","6":"0"},{"1":"60","2":"1","3":"3","4":"4","5":"0","6":"0"},{"1":"64","2":"1","3":"2","4":"5","5":"0","6":"0"},{"1":"42","2":"1","3":"0","4":"2","5":"0","6":"0"},{"1":"55","2":"1","3":"1","4":"5","5":"0","6":"0"},{"1":"48","2":"1","3":"1","4":"4","5":"0","6":"0"},{"1":"64","2":"1","3":"2","4":"3","5":"0","6":"0"},{"1":"59","2":"1","3":"2","4":"3","5":"1","6":"0"},{"1":"41","2":"1","3":"0","4":"5","5":"0","6":"0"},{"1":"50","2":"1","3":"1","4":"7","5":"0","6":"0"},{"1":"42","2":"1","3":"0","4":"5","5":"1","6":"0"},{"1":"41","2":"1","3":"0","4":"5","5":"0","6":"1"},{"1":"64","2":"1","3":"4","4":"7","5":"1","6":"1"},{"1":"66","2":"1","3":"3","4":"5","5":"1","6":"0"},{"1":"52","2":"1","3":"1","4":"8","5":"0","6":"1"},{"1":"65","2":"1","3":"5","4":"4","5":"1","6":"0"},{"1":"61","2":"1","3":"3","4":"7","5":"1","6":"0"},{"1":"57","2":"1","3":"3","4":"3","5":"1","6":"0"},{"1":"47","2":"1","3":"0","4":"3","5":"0","6":"0"},{"1":"68","2":"1","3":"1","4":"6","5":"1","6":"0"},{"1":"61","2":"1","3":"4","4":"10","5":"1","6":"1"},{"1":"42","2":"1","3":"1","4":"6","5":"0","6":"0"},{"1":"48","2":"1","3":"0","4":"7","5":"1","6":"1"},{"1":"68","2":"1","3":"5","4":"6","5":"0","6":"0"},{"1":"65","2":"1","3":"2","4":"4","5":"0","6":"0"},{"1":"70","2":"1","3":"3","4":"3","5":"1","6":"0"},{"1":"40","2":"1","3":"0","4":"5","5":"0","6":"0"},{"1":"59","2":"1","3":"2","4":"7","5":"0","6":"0"},{"1":"52","2":"1","3":"2","4":"6","5":"1","6":"0"},{"1":"68","2":"1","3":"4","4":"6","5":"1","6":"0"},{"1":"42","2":"1","3":"0","4":"5","5":"1","6":"0"},{"1":"48","2":"1","3":"0","4":"0","5":"1","6":"0"},{"1":"49","2":"1","3":"0","4":"5","5":"0","6":"0"},{"1":"69","2":"1","3":"3","4":"1","5":"1","6":"0"},{"1":"61","2":"1","3":"3","4":"7","5":"1","6":"0"},{"1":"67","2":"1","3":"0","4":"6","5":"0","6":"0"},{"1":"49","2":"1","3":"1","4":"5","5":"0","6":"0"},{"1":"68","2":"1","3":"0","4":"7","5":"0","6":"0"},{"1":"67","2":"1","3":"3","4":"6","5":"0","6":"0"},{"1":"60","2":"1","3":"3","4":"4","5":"1","6":"0"},{"1":"65","2":"1","3":"4","4":"6","5":"1","6":"0"},{"1":"64","2":"1","3":"1","4":"2","5":"0","6":"0"},{"1":"47","2":"1","3":"1","4":"1","5":"1","6":"0"},{"1":"44","2":"1","3":"0","4":"5","5":"0","6":"0"},{"1":"44","2":"1","3":"0","4":"7","5":"1","6":"0"},{"1":"53","2":"1","3":"1","4":"4","5":"0","6":"1"},{"1":"44","2":"1","3":"0","4":"5","5":"1","6":"0"},{"1":"49","2":"1","3":"0","4":"5","5":"0","6":"0"},{"1":"52","2":"1","3":"0","4":"4","5":"0","6":"0"},{"1":"66","2":"1","3":"5","4":"7","5":"0","6":"0"},{"1":"45","2":"1","3":"1","4":"5","5":"0","6":"1"},{"1":"68","2":"1","3":"3","4":"6","5":"1","6":"0"},{"1":"54","2":"1","3":"3","4":"5","5":"0","6":"1"},{"1":"57","2":"1","3":"1","4":"8","5":"0","6":"1"},{"1":"67","2":"1","3":"1","4":"3","5":"0","6":"0"},{"1":"67","2":"1","3":"2","4":"5","5":"1","6":"1"},{"1":"69","2":"1","3":"2","4":"0","5":"0","6":"0"},{"1":"60","2":"1","3":"2","4":"10","5":"1","6":"0"},{"1":"62","2":"1","3":"3","4":"9","5":"1","6":"1"},{"1":"66","2":"1","3":"2","4":"3","5":"1","6":"0"},{"1":"55","2":"1","3":"1","4":"7","5":"1","6":"0"},{"1":"51","2":"1","3":"0","4":"3","5":"0","6":"0"},{"1":"60","2":"1","3":"1","4":"3","5":"0","6":"0"},{"1":"63","2":"1","3":"0","4":"3","5":"1","6":"0"},{"1":"49","2":"1","3":"1","4":"2","5":"0","6":"0"},{"1":"63","2":"1","3":"3","4":"6","5":"1","6":"0"},{"1":"43","2":"1","3":"0","4":"3","5":"1","6":"0"},{"1":"62","2":"1","3":"1","4":"6","5":"0","6":"1"},{"1":"63","2":"1","3":"1","4":"5","5":"0","6":"1"},{"1":"63","2":"1","3":"2","4":"8","5":"1","6":"0"},{"1":"55","2":"1","3":"0","4":"8","5":"1","6":"0"},{"1":"43","2":"1","3":"0","4":"10","5":"1","6":"0"},{"1":"54","2":"1","3":"0","4":"1","5":"0","6":"0"},{"1":"53","2":"1","3":"1","4":"5","5":"0","6":"0"},{"1":"66","2":"1","3":"5","4":"6","5":"1","6":"0"},{"1":"56","2":"1","3":"5","4":"3","5":"0","6":"1"},{"1":"66","2":"1","3":"4","4":"8","5":"1","6":"0"},{"1":"43","2":"1","3":"1","4":"7","5":"1","6":"0"},{"1":"60","2":"1","3":"3","4":"3","5":"1","6":"1"},{"1":"41","2":"1","3":"0","4":"4","5":"0","6":"0"},{"1":"52","2":"1","3":"1","4":"9","5":"0","6":"1"},{"1":"51","2":"1","3":"0","4":"4","5":"0","6":"0"},{"1":"67","2":"1","3":"4","4":"7","5":"1","6":"0"},{"1":"59","2":"1","3":"2","4":"8","5":"0","6":"0"},{"1":"55","2":"1","3":"4","4":"9","5":"0","6":"0"},{"1":"45","2":"1","3":"1","4":"5","5":"1","6":"1"},{"1":"68","2":"1","3":"1","4":"6","5":"1","6":"1"},{"1":"56","2":"1","3":"1","4":"2","5":"0","6":"0"},{"1":"64","2":"1","3":"5","4":"5","5":"0","6":"1"},{"1":"48","2":"1","3":"1","4":"4","5":"0","6":"0"},{"1":"62","2":"1","3":"0","4":"4","5":"0","6":"0"},{"1":"60","2":"1","3":"2","4":"2","5":"1","6":"0"},{"1":"41","2":"1","3":"0","4":"5","5":"0","6":"0"},{"1":"48","2":"1","3":"0","4":"5","5":"1","6":"0"},{"1":"55","2":"1","3":"2","4":"5","5":"0","6":"1"},{"1":"67","2":"1","3":"2","4":"6","5":"0","6":"0"},{"1":"51","2":"1","3":"1","4":"5","5":"0","6":"0"},{"1":"53","2":"1","3":"1","4":"2","5":"0","6":"0"},{"1":"47","2":"1","3":"1","4":"4","5":"1","6":"0"},{"1":"67","2":"1","3":"1","4":"5","5":"1","6":"0"},{"1":"47","2":"1","3":"2","4":"2","5":"0","6":"0"},{"1":"46","2":"1","3":"0","4":"6","5":"1","6":"0"},{"1":"58","2":"1","3":"4","4":"6","5":"1","6":"1"},{"1":"63","2":"1","3":"0","4":"2","5":"1","6":"0"},{"1":"41","2":"1","3":"0","4":"8","5":"1","6":"0"},{"1":"52","2":"1","3":"1","4":"8","5":"0","6":"0"},{"1":"64","2":"1","3":"4","4":"8","5":"1","6":"1"},{"1":"65","2":"1","3":"1","4":"5","5":"1","6":"0"},{"1":"42","2":"1","3":"0","4":"5","5":"1","6":"0"},{"1":"64","2":"1","3":"0","4":"5","5":"0","6":"0"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>

</div>

### Check randomness

``` r
library(ggplot2)
ggplot(data, aes(x=age, y=..density..))  +
  geom_histogram(aes( fill=trt, color=trt), bins =30 ) +
  geom_density() +
  facet_grid(.~ trt)
```

![](test_files/figure-gfm/unnamed-chunk-2-1.png)<!-- --> From the plot
above, we observed that people in treatment group (trt = 1) were
slightly older than those in control group.

``` r
ggplot(data,aes(x=risk, fill=trt)) +  
  geom_bar(position = 'identity') +
  facet_grid(.~ trt)
```

![](test_files/figure-gfm/unnamed-chunk-3-1.png)<!-- -->

``` r
ggplot(data,aes(x=severity, fill=trt)) +
  geom_bar(position = 'identity') +
  facet_grid(.~ trt)
```

![](test_files/figure-gfm/unnamed-chunk-4-1.png)<!-- -->

Based on the plots above, itâ€™s not hard to observe that the
distributions of few varaibles are not the same across two g
